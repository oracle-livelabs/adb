{"table_name":"MOVIE","seq":2,"source_uri":null,"format":null,"sql":"create table movie as select cast(m.doc.movie_id as number) as movie_id, cast(m.doc.title as varchar2(200 byte)) as title, cast(m.doc.budget as number) as budget, cast(m.doc.gross as number) gross, cast(m.doc.list_price as number) as list_price, cast(m.doc.genre as varchar2(4000)) as genres, cast(m.doc.sku as varchar2(30 byte)) as sku, cast(m.doc.year as number) as year, to_date(m.doc.opening_date, 'YYYY-MM-DD') as opening_date, cast(m.doc.views as number) as views, cast(m.doc.cast as varchar2(4000 byte)) as cast, cast(m.doc.crew as varchar2(4000 byte)) as crew, cast(m.doc.studio as varchar2(4000 byte)) as studio, cast(m.doc.main_subject as varchar2(4000 byte)) as main_subject, cast(m.doc.awards as varchar2(4000 byte)) as awards, cast(m.doc.nominations as varchar2(4000 byte)) as nominations, cast(m.doc.runtime as number) as runtime, substr(cast(m.doc.summary as varchar2(4000 byte)),1, 4000) as summary from json_movie_data_ext m","constraints":"alter table movie add ( constraint pk_movie_id primary key(\"MOVIE_ID\"),CONSTRAINT movie_cast_json CHECK (cast IS JSON),CONSTRAINT movie_genre_json CHECK (genres IS JSON),CONSTRAINT movie_crew_json CHECK (crew IS JSON),CONSTRAINT movie_studio_json CHECK (studio IS JSON),CONSTRAINT movie_awards_json CHECK (awards IS JSON),CONSTRAINT movie_nominations_json CHECK (nominations IS JSON))","post_load_proc":null,"description":"List of movies sourced from Wikipedia","dependencies":["JSON_MOVIE_DATA_EXT"]}
{"table_name":"MOVIESTREAM_CHURN","seq":1,"source_uri":"https://objectstorage.us-ashburn-1.oraclecloud.com/n/c4u04/b/moviestream_sandbox/o/moviestream_churn/*.csv","format":{"dateformat":"YYYY-MM-DD", "skipheaders":"1", "delimiter":",", "ignoreblanklines":"true", "removequotes":"true", "blankasnull":"true", "trimspaces":"lrtrim", "truncatecol":"true", "ignoremissingcolumns":"true"},"sql":"CREATE TABLE MOVIESTREAM_CHURN (CUST_ID NUMBER, IS_CHURNER NUMBER, AGE NUMBER, CITY VARCHAR2(100) , CREDIT_BALANCE NUMBER, EDUCATION VARCHAR2(40) , EMAIL VARCHAR2(500) , FIRST_NAME VARCHAR2(200) , GENDER VARCHAR2(20) , HOUSEHOLD_SIZE NUMBER, INCOME_LEVEL VARCHAR2(20) , JOB_TYPE VARCHAR2(200) , LAST_NAME VARCHAR2(200) , LOC_LAT NUMBER, LOC_LONG NUMBER, MARITAL_STATUS VARCHAR2(8) , YRS_CUSTOMER NUMBER, YRS_RESIDENCE NUMBER, GENRE_ACTION NUMBER, GENRE_ADVENTURE NUMBER, GENRE_ANIMATION NUMBER, GENRE_BIOGRAPHY NUMBER, GENRE_COMEDY NUMBER, GENRE_CRIME NUMBER, GENRE_DOCUMENTARY NUMBER, GENRE_DRAMA NUMBER, GENRE_FAMILY NUMBER, GENRE_FANTASY NUMBER, GENRE_FILM_NOIR NUMBER, GENRE_HISTORY NUMBER, GENRE_HORROR NUMBER, GENRE_MUSICAL NUMBER, GENRE_MYSTERY NUMBER, GENRE_NEWS NUMBER, GENRE_REALITY_TV NUMBER, GENRE_ROMANCE NUMBER, GENRE_SCI_FI NUMBER, GENRE_SPORT NUMBER, GENRE_THRILLER NUMBER, GENRE_WAR NUMBER, GENRE_WESTERN NUMBER, AGG_NTRANS_M3 NUMBER, AGG_NTRANS_M4 NUMBER, AGG_NTRANS_M5 NUMBER, AGG_NTRANS_M6 NUMBER, AGG_SALES_M3 NUMBER, AGG_SALES_M4 NUMBER, AGG_SALES_M5 NUMBER, AGG_SALES_M6 NUMBER, AVG_DISC_M3 NUMBER, AVG_DISC_M3_11 NUMBER, AVG_DISC_M3_5 NUMBER, AVG_NTRANS_M3_5 NUMBER, AVG_SALES_M3_5 NUMBER, DISC_PCT_DIF_M3_5_M6_11 NUMBER, DISC_PCT_DIF_M3_5_M6_8 NUMBER, SALES_PCT_DIF_M3_5_M6_8 NUMBER, TRANS_PCT_DIF_M3_5_M6_8 NUMBER)","constraints":null,"post_load_proc":null,"description":"Used for creating ML models","dependencies":null}
{"table_name":"EXT_POTENTIAL_CHURNERS","seq":1,"source_uri":null,"format":null,"sql":"begin dbms_cloud.create_external_table(table_name => 'ext_potential_churners', file_uri_list => 'https://objectstorage.us-ashburn-1.oraclecloud.com/n/c4u04/b/moviestream_sandbox/o/potential_churners/*.csv', format => '{\"dateformat\":\"YYYY-MM-DD\", \"skipheaders\":\"1\", \"delimiter\":\",\", \"ignoreblanklines\":\"true\", \"removequotes\":\"true\", \"blankasnull\":\"true\", \"trimspaces\":\"lrtrim\", \"truncatecol\":\"true\", \"ignoremissingcolumns\":\"true\"}', column_list => 'cust_id number, will_churn number, prob_churn number'); end;","constraints":null,"post_load_proc":null,"description":"Saved list of potential churners","dependencies":null}
{"table_name":"GENRE","seq":1,"source_uri":"https://objectstorage.us-ashburn-1.oraclecloud.com/n/c4u04/b/moviestream_gold/o/genre/*.csv","format":{"dateformat":"YYYY-MM-DD", "skipheaders":"1", "delimiter":",", "ignoreblanklines":"true", "removequotes":"true", "blankasnull":"true", "trimspaces":"lrtrim", "truncatecol":"true", "ignoremissingcolumns":"true"},"sql":"CREATE TABLE GENRE (GENRE_ID NUMBER, NAME VARCHAR2(30))","constraints":"alter table genre add constraint pk_genre_id primary key(\"GENRE_ID\")","post_load_proc":null,"description":"Movie genres","dependencies":null}
{"table_name":"CUSTOMER_EXTENSION","seq":1,"source_uri":"https://objectstorage.us-ashburn-1.oraclecloud.com/n/c4u04/b/moviestream_landing/o/customer_extension/*.csv","format":{"dateformat":"YYYY-MM-DD", "skipheaders":"1", "delimiter":",", "ignoreblanklines":"true", "removequotes":"true", "blankasnull":"true", "trimspaces":"lrtrim", "truncatecol":"true", "ignoremissingcolumns":"true"},"sql":"CREATE TABLE CUSTOMER_EXTENSION (CUST_ID NUMBER, LAST_NAME VARCHAR2(200) , FIRST_NAME VARCHAR2(200) , EMAIL VARCHAR2(500) , AGE NUMBER, COMMUTE_DISTANCE NUMBER, CREDIT_BALANCE NUMBER, EDUCATION VARCHAR2(40) , FULL_TIME VARCHAR2(40) , GENDER VARCHAR2(20) , HOUSEHOLD_SIZE NUMBER, INCOME NUMBER, INCOME_LEVEL VARCHAR2(20) , INSUFF_FUNDS_INCIDENTS NUMBER, JOB_TYPE VARCHAR2(200) , LATE_MORT_RENT_PMTS NUMBER, MARITAL_STATUS VARCHAR2(8) , MORTGAGE_AMT NUMBER, NUM_CARS NUMBER, NUM_MORTGAGES NUMBER, PET VARCHAR2(40) , RENT_OWN VARCHAR2(40) , SEGMENT_ID NUMBER, WORK_EXPERIENCE NUMBER, YRS_CURRENT_EMPLOYER NUMBER, YRS_RESIDENCE NUMBER)","constraints":"alter table customer_extension add constraint pk_custextension_cust_id primary key(\"CUST_ID\")","post_load_proc":null,"description":"Customer demographics","dependencies":null}
{"table_name":"TIME","seq":1,"source_uri":null,"format":null,"sql":"CREATE TABLE TIME (DAY_ID timestamp(6), DAY_NAME VARCHAR2(36)  GENERATED ALWAYS AS (TO_CHAR(DAY_ID,'fmDAY')) VIRTUAL , DAY_DOW NUMBER GENERATED ALWAYS AS (CAST(TO_CHAR(DAY_ID,'fmd') AS number)) VIRTUAL , DAY_DOM NUMBER GENERATED ALWAYS AS (CAST(TO_CHAR(DAY_ID,'fmDD') AS number)) VIRTUAL , DAY_DOY NUMBER GENERATED ALWAYS AS (CAST(TO_CHAR(DAY_ID,'fmDDD') AS number)) VIRTUAL , WEEK_WOM NUMBER GENERATED ALWAYS AS (CAST(TO_CHAR(DAY_ID,'fmw') AS number)) VIRTUAL , WEEK_WOY NUMBER GENERATED ALWAYS AS (CAST(TO_CHAR(DAY_ID,'fmWW') AS number)) VIRTUAL , MONTH_MOY NUMBER GENERATED ALWAYS AS (CAST(TO_CHAR(DAY_ID,'fmMM') AS number)) VIRTUAL , MONTH_NAME VARCHAR2(36)  GENERATED ALWAYS AS (TO_CHAR(DAY_ID,'fmMONTH')) VIRTUAL , MONTH_ANAME VARCHAR2(12)  GENERATED ALWAYS AS (TO_CHAR(DAY_ID,'fmMON')) VIRTUAL , QUARTER_NAME VARCHAR2(7)  GENERATED ALWAYS AS ('Q'||TO_CHAR(DAY_ID,'fmq')||'-'||TO_CHAR(DAY_ID,'fmYYYY')) VIRTUAL , QUARTER_QOY NUMBER GENERATED ALWAYS AS (CAST(TO_CHAR(DAY_ID,'fmq') AS number)) VIRTUAL , YEAR_NAME NUMBER GENERATED ALWAYS AS (CAST(TO_CHAR(DAY_ID,'fmYYYY') AS number)) VIRTUAL)","constraints":"alter table time add constraint pk_day primary key(\"DAY_ID\")","post_load_proc":null,"description":"Daily time table with extended attributes","dependencies":null}
{"table_name":"PIZZA_LOCATION","seq":1,"source_uri":"https://objectstorage.us-ashburn-1.oraclecloud.com/n/c4u04/b/moviestream_landing/o/pizza_location/*.csv","format":{"dateformat":"YYYY-MM-DD", "skipheaders":"1", "delimiter":",", "ignoreblanklines":"true", "removequotes":"true", "blankasnull":"true", "trimspaces":"lrtrim", "truncatecol":"true", "ignoremissingcolumns":"true"},"sql":"CREATE TABLE PIZZA_LOCATION (PIZZA_LOC_ID NUMBER, LAT NUMBER, LON NUMBER, CHAIN_ID NUMBER, CHAIN VARCHAR2(30) , ADDRESS VARCHAR2(250) , CITY VARCHAR2(250) , STATE VARCHAR2(26) , POSTAL_CODE VARCHAR2(38) , COUNTY VARCHAR2(250))","constraints":"alter table pizza_location add constraint pk_pizza_loc_id primary key(\"PIZZA_LOC_ID\")","post_load_proc":"add_spatial_pizza","description":"Partner pizza locations used for promotions","dependencies":null}
{"table_name":"CUSTOMER_CONTACT","seq":1,"source_uri":"https://objectstorage.us-ashburn-1.oraclecloud.com/n/c4u04/b/moviestream_gold/o/customer_contact/*.csv","format":{"dateformat":"YYYY-MM-DD", "skipheaders":"1", "delimiter":",", "ignoreblanklines":"true", "removequotes":"true", "blankasnull":"true", "trimspaces":"lrtrim", "truncatecol":"true", "ignoremissingcolumns":"true"},"sql":"CREATE TABLE CUSTOMER_CONTACT (CUST_ID NUMBER, LAST_NAME VARCHAR2(200) , FIRST_NAME VARCHAR2(200) , EMAIL VARCHAR2(500) , STREET_ADDRESS VARCHAR2(400) , POSTAL_CODE VARCHAR2(10) , CITY VARCHAR2(100) , STATE_PROVINCE VARCHAR2(100) , COUNTRY VARCHAR2(400) , COUNTRY_CODE VARCHAR2(2) , CONTINENT VARCHAR2(400) , YRS_CUSTOMER NUMBER, PROMOTION_RESPONSE NUMBER, LOC_LAT NUMBER, LOC_LONG NUMBER)","constraints":"alter table customer_contact add constraint pk_custcontact_cust_id primary key(\"CUST_ID\")","post_load_proc":"add_spatial_cust_contact","description":"Customer contact details","dependencies":null}
{"table_name":"CUSTSALES","seq":3,"source_uri":"https://objectstorage.us-ashburn-1.oraclecloud.com/n/c4u04/b/moviestream_gold/o/custsales/*.parquet","format":{"type":"parquet",  "schema": "all"},"sql":"create table custsales ( DAY_ID TIMESTAMP(6), GENRE_ID NUMBER, MOVIE_ID NUMBER, CUST_ID NUMBER, APP VARCHAR2(100), DEVICE VARCHAR2(100), OS VARCHAR2(100), PAYMENT_METHOD VARCHAR2(100), LIST_PRICE BINARY_DOUBLE, DISCOUNT_TYPE VARCHAR2(100), DISCOUNT_PERCENT BINARY_DOUBLE, ACTUAL_PRICE BINARY_DOUBLE )","constraints":"alter table custsales add (primary key (cust_id, movie_id, day_id), constraint fk_custsales_movie_id foreign key(\"MOVIE_ID\") references movie(\"MOVIE_ID\"),constraint fk_custsales_cust_id foreign key(\"CUST_ID\") references customer(\"CUST_ID\"),constraint fk_custsales_genre_id foreign key(\"GENRE_ID\") references genre(\"GENRE_ID\"))","post_load_proc":null,"description":"Customer sales data","dependencies":["movie","customer","genre","JSON_MOVIE_DATA_EXT","CUSTOMER_CONTACT","CUSTOMER_EXTENSION"]}
{"table_name":"CUSTOMER","seq":2,"source_uri":null,"format":null,"sql":"create table CUSTOMER as select  cc.CUST_ID, cc.LAST_NAME, cc.FIRST_NAME, cc.EMAIL, cc.STREET_ADDRESS, cc.POSTAL_CODE, cc.CITY, cc.STATE_PROVINCE, cc.COUNTRY, cc.COUNTRY_CODE, cc.CONTINENT, cc.YRS_CUSTOMER, cc.PROMOTION_RESPONSE, cc.LOC_LAT, cc.LOC_LONG, ce.AGE, ce.COMMUTE_DISTANCE, ce.CREDIT_BALANCE, ce.EDUCATION, ce.FULL_TIME, ce.GENDER, ce.HOUSEHOLD_SIZE, ce.INCOME, ce.INCOME_LEVEL, ce.INSUFF_FUNDS_INCIDENTS, ce.JOB_TYPE, ce.LATE_MORT_RENT_PMTS, ce.MARITAL_STATUS, ce.MORTGAGE_AMT, ce.NUM_CARS, ce.NUM_MORTGAGES, ce.PET, ce.RENT_OWN, ce.SEGMENT_ID, ce.WORK_EXPERIENCE, ce.YRS_CURRENT_EMPLOYER, ce.YRS_RESIDENCE from CUSTOMER_CONTACT cc, CUSTOMER_EXTENSION ce where cc.cust_id = ce.cust_id","constraints":"alter table customer add constraint pk_customer_cust_id primary key(\"CUST_ID\")","post_load_proc":null,"description":"Combines customer contact and demographic data","dependencies":["CUSTOMER_CONTACT","CUSTOMER_EXTENSION"]}
{"table_name":"CUSTOMER_PROMOTIONS","seq":1,"source_uri":"https://objectstorage.us-ashburn-1.oraclecloud.com/n/c4u04/b/moviestream_sandbox/o/customer_promotions/*.csv","format":{"dateformat":"YYYY-MM-DD", "skipheaders":"1", "delimiter":",", "ignoreblanklines":"true", "removequotes":"true", "blankasnull":"true", "trimspaces":"lrtrim", "truncatecol":"true", "ignoremissingcolumns":"true"},"sql":"CREATE TABLE CUSTOMER_PROMOTIONS (CUST_ID NUMBER, LAST_NAME VARCHAR2(200) , FIRST_NAME VARCHAR2(200) , EMAIL VARCHAR2(500) , STREET_ADDRESS VARCHAR2(400) , POSTAL_CODE VARCHAR2(10) , CITY VARCHAR2(100) , STATE_PROVINCE VARCHAR2(100) , COUNTRY VARCHAR2(400) , COUNTRY_CODE VARCHAR2(2) , CONTINENT VARCHAR2(400) , YRS_CUSTOMER NUMBER, PROMOTION_RESPONSE NUMBER, LOC_LAT NUMBER, LOC_LONG NUMBER, AGE NUMBER, COMMUTE_DISTANCE NUMBER, CREDIT_BALANCE NUMBER, EDUCATION VARCHAR2(40) , FULL_TIME VARCHAR2(40) , GENDER VARCHAR2(20) , HOUSEHOLD_SIZE NUMBER, INCOME NUMBER, INCOME_LEVEL VARCHAR2(20) , INSUFF_FUNDS_INCIDENTS NUMBER, JOB_TYPE VARCHAR2(200) , LATE_MORT_RENT_PMTS NUMBER, MARITAL_STATUS VARCHAR2(8) , MORTGAGE_AMT NUMBER, NUM_CARS NUMBER, NUM_MORTGAGES NUMBER, PET VARCHAR2(40) , RENT_OWN VARCHAR2(40) , SEGMENT_ID NUMBER, WORK_EXPERIENCE NUMBER, YRS_CURRENT_EMPLOYER NUMBER, YRS_RESIDENCE NUMBER)","constraints":"alter table customer_promotions add constraint customer_promotions_pk primary key(cust_id)","post_load_proc":null,"description":"Sample of customers","dependencies":null}
{"table_name":"CUSTOMER_SEGMENT","seq":1,"source_uri":"https://objectstorage.us-ashburn-1.oraclecloud.com/n/c4u04/b/moviestream_landing/o/customer_segment/*.csv","format":{"dateformat":"YYYY-MM-DD", "skipheaders":"1", "delimiter":",", "ignoreblanklines":"true", "removequotes":"true", "blankasnull":"true", "trimspaces":"lrtrim", "truncatecol":"true", "ignoremissingcolumns":"true"},"sql":"CREATE TABLE CUSTOMER_SEGMENT (SEGMENT_ID NUMBER, NAME VARCHAR2(100) , SHORT_NAME VARCHAR2(100))","constraints":"alter table customer_segment add constraint pk_custsegment_id primary key(\"SEGMENT_ID\")","post_load_proc":null,"description":"Groupings of customers based on attributes","dependencies":null}
{"table_name":"CUSTSALES_PROMOTIONS","seq":4,"source_uri":null,"format":null,"sql":"create table custsales_promotions as select * from custsales c where c.cust_id in (select p.cust_id from customer_promotions p)","constraints":"alter table custsales_promotions add (constraint pk_custsales_promotions primary key (cust_id, movie_id, day_id),constraint fk_custsales_promotions_cust_id foreign key(cust_id) references customer_promotions(cust_id),constraint fk_custsales_promotions_movie_id foreign key(movie_id) references movie(movie_id))","post_load_proc":null,"description":"Sample of customer sales data","dependencies":["CUSTOMER_PROMOTIONS","MOVIE","CUSTSALES","JSON_MOVIE_DATA_EXT"]}
{"table_name":"JSON_MOVIE_DATA_EXT","seq":1,"source_uri":null,"format":null,"sql":"begin dbms_cloud.create_external_table (table_name => 'json_movie_data_ext',file_uri_list => 'https://objectstorage.us-ashburn-1.oraclecloud.com/n/c4u04/b/moviestream_gold/o/movie/*.json',column_list => 'doc varchar2(32000)',field_list => 'doc char(30000)',format => '{\"skipheaders\":\"0\", \"delimiter\":\"\\\\n\", \"ignoreblanklines\":\"true\"}'); end;","constraints":null,"post_load_proc":null,"description":"Movie data in JSON format on object store","dependencies":null}