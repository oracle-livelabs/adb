[{"layout":"zeppelin","isRunnable":true,"template":"dsrgmn3y","templateConfig":"{\"visualization\":{\"filters\":[{\"_id\":1583324064459,\"type\":\"styling\",\"enabled\":true,\"conditions\":{\"operator\":\"and\",\"conditions\":[{\"property\":\"hiddenConnection\",\"operator\":\"*\",\"value\":\"\"}]},\"component\":\"edge\",\"target\":\"edge\",\"properties\":{\"colors\":[\"rgba(0, 0, 0, 0.1)\"],\"style\":[\"dashed\"],\"legendTitle\":[\"Hidden Connection\"]}},{\"_id\":1590499315755,\"type\":\"aggregation\",\"enabled\":true,\"conditions\":{\"operator\":\"and\",\"conditions\":[]},\"component\":\"vertex\",\"target\":\"vertex\",\"properties\":{},\"aggregation\":[{\"source\":\"\",\"type\":\"average\"}]}],\"version\":4}}","isEditable":true,"name":"adb-speaks-human-notebook-aiw2025","description":null,"type":"low","paragraphs":[{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","# Use natural language to query your data","","Autonomous Database makes it simple to query your data using natural language. The person asking the question doesn't need to know where the data is stored, its structure or how to combine it with other data to get results. All of these tasks are handled by a large language model and Autonomous Database.","","The following paragraphs will show you how to:","1. Create a credential","2. Create an AI profile ","3. Have general AI chat conversations","4. Query data using natural language","5. Show the SQL generated for a query","","## Use an OCI credential to access OCI Generative AI","A credential is used to sign LLM API requests. This workshop uses an OCI credential to access OCI Generative AI model; your database has been granted privileges to access OCI GenAI. This code has already been run by the setup script; you don't need to run it. It is typically run by the ADMIN user:"],"enabled":true,"result":{"startTime":1755875015968,"interpreter":"md.low","endTime":1755875016431,"results":[{"message":"<h1 id=\"use-natural-language-to-query-your-data\">Use natural language to query your data<\/h1>\n<p>Autonomous Database makes it simple to query your data using natural language. The person asking the question doesn't need to know where the data is stored, its structure or how to combine it with other data to get results. All of these tasks are handled by a large language model and Autonomous Database.<\/p>\n<p>The following paragraphs will show you how to:<\/p>\n<ol>\n<li>Create a credential<\/li>\n<li>Create an AI profile<\/li>\n<li>Have general AI chat conversations<\/li>\n<li>Query data using natural language<\/li>\n<li>Show the SQL generated for a query<\/li>\n<\/ol>\n<h2 id=\"use-an-oci-credential-to-access-oci-generative-ai\">Use an OCI credential to access OCI Generative AI<\/h2>\n<p>A credential is used to sign LLM API requests. This workshop uses an OCI credential to access OCI Generative AI model; your database has been granted privileges to access OCI GenAI. This code has already been run by the setup script; you don't need to run it. It is typically run by the ADMIN user:<\/p>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","## Use AI profiles to access your LLM","Profiles capture the properties of your LLM provider plus the tables and views you want to enable for natural language queries. You can create multiple profiles (e.g. for different providers), although only one is active for a given session.","### Create an AI profile","To get started: you'll need to: ","* Create a profile that describes your LLM provider and the metadata (schemas, tables, views, etc.) that can be used for natural language queries. You can have multiple profiles - each pointing to different models.","* Set the profile for your session.","","The following script enables you to choose the LLM provider that you want to use. OCI GenAI is the default.","","The AI_PROVIDER variable in the script is used to specify the LLM provider that you are using. The valid values for this workshop (Select AI does support other providers) are:","1. oci (default)","2. azure","3. google","4. openai","","The AI_CREDENTIAL_NAME variable is used to specify the name of your credential. OCI is using an OCI credential.","","In this notebook, we are using the OCI LLM provider. "],"enabled":true,"result":{"startTime":1755877000911,"interpreter":"md.low","endTime":1755877001416,"results":[{"message":"<h2 id=\"use-ai-profiles-to-access-your-llm\">Use AI profiles to access your LLM<\/h2>\n<p>Profiles capture the properties of your LLM provider plus the tables and views you want to enable for natural language queries. You can create multiple profiles (e.g. for different providers), although only one is active for a given session.<\/p>\n<h3 id=\"create-an-ai-profile\">Create an AI profile<\/h3>\n<p>To get started: you'll need to:<\/p>\n<ul>\n<li>Create a profile that describes your LLM provider and the metadata (schemas, tables, views, etc.) that can be used for natural language queries. You can have multiple profiles - each pointing to different models.<\/li>\n<li>Set the profile for your session.<\/li>\n<\/ul>\n<p>The following script enables you to choose the LLM provider that you want to use. OCI GenAI is the default.<\/p>\n<p>The AI_PROVIDER variable in the script is used to specify the LLM provider that you are using. The valid values for this workshop (Select AI does support other providers) are:<\/p>\n<ol>\n<li>oci (default)<\/li>\n<li>azure<\/li>\n<li>google<\/li>\n<li>openai<\/li>\n<\/ol>\n<p>The AI_CREDENTIAL_NAME variable is used to specify the name of your credential. OCI is using an OCI credential.<\/p>\n<p>In this notebook, we are using the OCI LLM provider.<\/p>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":0,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"Create AI profiles for different LLM providers","message":["%script","","DECLARE","   AI_PROVIDER varchar2(10) := 'oci';  -- valid values are oci, azure, google, openai","   AI_CREDENTIAL_NAME varchar2(100) := 'GENAI_CRED'; -- The name of your credential.","   -- When using Azure OpenAI - fill in the fields below","   AZURE_OPENAI_RESOURCE_NAME varchar2(100) :='';  -- This is your Azure OpenAI resource name","   AZURE_OPENAI_DEPLOYMENT_NAME  varchar2(100):='';  -- This is your Azure OpenAI deployment name","BEGIN","    ","    -- ~~~~~~~~~~~~~~","    -- recreate the profile ","    -- ~~~~~~~~~~~~~~    ","","    dbms_cloud_ai.drop_profile (","        profile_name => 'GENAI',","        force => true","    );","    -- create an AI profile. The attributes are different for providers.","    IF upper(AI_PROVIDER) = 'AZURE' THEN","      dbms_cloud_ai.create_profile (","          profile_name => 'GENAI',","          attributes =>","              '{\"provider\": \"azure\",","                  \"azure_resource_name\": \"AZURE_OPENAI_RESOURCE_NAME\",","                  \"azure_deployment_name\": \"AZURE_OPENAI_DEPLOYMENT_NAME\",","                  \"credential_name\": \"AI_CREDENTIAL_NAME\",","                  \"comments\":\"true\",","                  \"object_list\": [","                  {\"owner\": \"MOVIESTREAM\", \"name\": \"GENRE\"},","                  {\"owner\": \"MOVIESTREAM\", \"name\": \"CUSTOMER\"},","                  {\"owner\": \"MOVIESTREAM\", \"name\": \"PIZZA_SHOP\"},","                  {\"owner\": \"MOVIESTREAM\", \"name\": \"STREAMS\"},","                  {\"owner\": \"MOVIESTREAM\", \"name\": \"MOVIES\"},","                  {\"owner\": \"MOVIESTREAM\", \"name\": \"ACTORS\"}","                  ]","                  }'","      );","    ELSE","      dbms_cloud_ai.create_profile (","          profile_name => 'GENAI',","          attributes =>","              '{\"provider\": \"' || AI_PROVIDER || '\",","                  \"credential_name\": \"' || AI_CREDENTIAL_NAME ||'\",","                  \"region\": \"sa-saopaulo-1\",","                  \"comments\":\"true\",","                  \"object_list\": [","                  {\"owner\": \"MOVIESTREAM\", \"name\": \"GENRE\"},","                  {\"owner\": \"MOVIESTREAM\", \"name\": \"CUSTOMER\"},","                  {\"owner\": \"MOVIESTREAM\", \"name\": \"PIZZA_SHOP\"},","                  {\"owner\": \"MOVIESTREAM\", \"name\": \"STREAMS\"},","                  {\"owner\": \"MOVIESTREAM\", \"name\": \"MOVIES\"},","                  {\"owner\": \"MOVIESTREAM\", \"name\": \"ACTORS\"}","                  ]","                }'","      );","    END IF;","","-- ~~~~~~~~~~~~~~","-- Set the AI profile for this session","-- ~~~~~~~~~~~~~~","","dbms_cloud_ai.set_profile(profile_name =>'genai');","END;","/"],"enabled":true,"result":{"startTime":1734042102019,"interpreter":"script.low","endTime":1734042112331,"results":null,"taskStatus":null,"forms":null,"status":null},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","## Ask natural language questions!","","You can now ask questions using `SELECT AI`. **AI** is a special keyword in the select statement that tells Autonomous Database that the subsequent text will be either or an action or the natural language question.","","Here are the actions:","1. chat    - general AI chat","2. runsql  - [default] ask a question and get a structured result","3. narrate - ask a question and get a conversational result","4. showsql - SQL used to produce the result","5. explainsql - an explanation of the SQL used to produce the result","","Enough explaining. Just give it a try!","","Start by asking a general question that is not going to be answered by our data. But, the answer may lead to questions that we want to ask of our data:"],"enabled":true,"result":{"startTime":1734042204478,"interpreter":"md.low","endTime":1734042213734,"results":[{"message":"<h2 id=\"ask-natural-language-questions\">Ask natural language questions!<\/h2>\n<p>You can now ask questions using <code>SELECT AI<\/code>. <strong>AI<\/strong> is a special keyword in the select statement that tells Autonomous Database that the subsequent text will be either or an action or the natural language question.<\/p>\n<p>Here are the actions:<\/p>\n<ol>\n<li>chat    - general AI chat<\/li>\n<li>runsql  - [default] ask a question and get a structured result<\/li>\n<li>narrate - ask a question and get a conversational result<\/li>\n<li>showsql - SQL used to produce the result<\/li>\n<li>explainsql - an explanation of the SQL used to produce the result<\/li>\n<\/ol>\n<p>Enough explaining. Just give it a try!<\/p>\n<p>Start by asking a general question that is not going to be answered by our data. But, the answer may lead to questions that we want to ask of our data:<\/p>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":"[{\"raw\":{\"layout\":\"beautify\",\"lastColumns\":[],\"version\":1},\"table\":{\"version\":1}}]","hideInIFrame":false,"selectedVisualization":"raw","title":"Ask a general question","message":["%script","select ai chat what are considered the best movies produced in the past 20 years"],"enabled":true,"result":{"startTime":1734042228164,"interpreter":"script.low","endTime":1734042254521,"results":null,"taskStatus":null,"forms":null,"status":null},"sizeX":0,"hideCode":false,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","#### Take a quick look at some tables","Numerous tables were included as part of the AI profile:","* movies","* streams","* customer_extension","* customer_contact","* customer_segment","* pizza_shop","* genre","* actors","","","These are the only tables that will be accessed by natural language queries. Let's take a look at a few of the tables:"],"enabled":true,"result":{"startTime":1734028127318,"interpreter":"md.low","endTime":1734028127814,"results":[{"message":"<h4 id=\"take-a-quick-look-at-some-tables\">Take a quick look at some tables<\/h4>\n<p>Numerous tables were included as part of the AI profile:<\/p>\n<ul>\n<li>movies<\/li>\n<li>streams<\/li>\n<li>customer_extension<\/li>\n<li>customer_contact<\/li>\n<li>customer_segment<\/li>\n<li>pizza_shop<\/li>\n<li>genre<\/li>\n<li>actors<\/li>\n<\/ul>\n<p>These are the only tables that will be accessed by natural language queries. Let's take a look at a few of the tables:<\/p>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Customer movie streams","message":["%sql ","","","-- transactions - who is watching what movies","--~~~~~~~~~~~~~~~~~~~","","select * from streams where rownum <= 10;"],"enabled":true,"result":{"startTime":1734042353400,"interpreter":"sql.low","endTime":1734042353906,"results":null,"taskStatus":null,"forms":null,"status":null},"sizeX":0,"hideCode":false,"width":4,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Movies","message":["%sql","","","-- movies and their attributes","--~~~~~~~~~~~~~~~~~~~","","select * from movies where title like '%Godfather%';"],"enabled":true,"result":{"startTime":1734042372367,"interpreter":"sql.low","endTime":1734042379853,"results":null,"taskStatus":null,"forms":null,"status":null},"sizeX":0,"hideCode":false,"width":4,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Customer","message":["%sql","","","-- customer info","--~~~~~~~~~~~~~~~~~~~","select * from customer_extension where rownum <= 10"],"enabled":true,"result":{"startTime":1734042399022,"interpreter":"sql.low","endTime":1734042399530,"results":null,"taskStatus":null,"forms":null,"status":null},"sizeX":0,"hideCode":false,"width":4,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","#### See the different types of actions for a simple natural language query","We described the different actions above: runsql, narrate, showsql, explainsql and chat. Whereas chat is just a general question, narrate and runsql are questions about our data. Take a look at the results from the different actions:"],"enabled":true,"result":{"startTime":1734028134907,"interpreter":"md.low","endTime":1734028135373,"results":[{"message":"<h4 id=\"see-the-different-types-of-actions-for-a-simple-natural-language-query\">See the different types of actions for a simple natural language query<\/h4>\n<p>We described the different actions above: runsql, narrate, showsql, explainsql and chat. Whereas chat is just a general question, narrate and runsql are questions about our data. Take a look at the results from the different actions:<\/p>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"Action: runsql","message":["%sql","","","select ai runsql what are our total sales"],"enabled":true,"result":{"startTime":1734042434424,"interpreter":"sql.low","endTime":1734042438258,"results":null,"taskStatus":null,"forms":null,"status":null},"sizeX":0,"hideCode":false,"width":4,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"Action: narrate","message":["%script","","","select ai narrate what are our total sales"],"enabled":true,"result":{"startTime":1734042449534,"interpreter":"script.low","endTime":1734042452822,"results":null,"taskStatus":null,"forms":null,"status":null},"sizeX":0,"hideCode":false,"width":4,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"Action: showsql","message":["%script","","","select ai showsql what are our total sales"],"enabled":true,"result":{"startTime":1734042466418,"interpreter":"script.low","endTime":1734042468604,"results":null,"taskStatus":null,"forms":null,"status":null},"sizeX":0,"hideCode":false,"width":4,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":"[{\"raw\":{\"layout\":\"beautify\",\"lastColumns\":[],\"version\":1}}]","hideInIFrame":false,"selectedVisualization":"raw","title":"Action: explainsql","message":["%script","","","select ai explainsql what are our total sales"],"enabled":true,"result":{"startTime":1734042478717,"interpreter":"script.low","endTime":1734042484995,"results":null,"taskStatus":null,"forms":null,"status":null},"sizeX":0,"hideCode":false,"width":4,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","#### Ask tougher questions","That first question was pretty easy. These will be a bit harder. Some things to notice when you check out the generated SQL:","* Finds tables to join","* Determines columns to query - even when the columns aren't mentioned in the query"],"enabled":true,"result":{"startTime":1734028140891,"interpreter":"md.low","endTime":1734028141364,"results":[{"message":"<h4 id=\"ask-tougher-questions\">Ask tougher questions<\/h4>\n<p>That first question was pretty easy. These will be a bit harder. Some things to notice when you check out the generated SQL:<\/p>\n<ul>\n<li>Finds tables to join<\/li>\n<li>Determines columns to query - even when the columns aren't mentioned in the query<\/li>\n<\/ul>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Sales by movie","message":["%sql","","","select ai what are our total sales by movie with best movies first"],"enabled":true,"result":{"startTime":1734042515931,"interpreter":"sql.low","endTime":1734042520960,"results":null,"taskStatus":null,"forms":null,"status":null},"sizeX":0,"hideCode":false,"width":6,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"Joins sales_sample and movie tables","message":["%sql","","","select ai showsql what are our total sales by movie with best movies first;"],"enabled":true,"result":{"startTime":1734042532075,"interpreter":"sql.low","endTime":1734042535619,"results":null,"taskStatus":null,"forms":null,"status":null},"sizeX":0,"hideCode":false,"width":6,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Top movies for latest month","message":["%sql","","","select ai what are our top 5 selling movies for the latest month;"],"enabled":true,"result":{"startTime":1734042562953,"interpreter":"sql.low","endTime":1734042568364,"results":null,"taskStatus":null,"forms":null,"status":null},"sizeX":0,"hideCode":false,"width":6,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"Understand dates","message":["%sql","","","select ai showsql what are our top  5 selling movies for the latest month;"],"enabled":true,"result":{"startTime":1734027860586,"interpreter":"sql.low","endTime":1734027865673,"results":null,"taskStatus":null,"forms":null,"status":null},"sizeX":0,"hideCode":false,"width":6,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Harrison Ford movies","message":["%sql","","","select ai what are our sales for movies starring Harrison Ford broken out by movie;"],"enabled":true,"result":{"startTime":1734027866168,"interpreter":"sql.low","endTime":1734027870657,"results":null,"taskStatus":null,"forms":null,"status":null},"sizeX":0,"hideCode":false,"width":6,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"Model maps starring to ACTOR column","message":["%script","","","select ai showsql select ai what are our sales for movies starring Harrison Ford broken out by movie;"],"enabled":true,"result":{"startTime":1734027871157,"interpreter":"script.low","endTime":1734027875453,"results":null,"taskStatus":null,"forms":null,"status":null},"sizeX":0,"hideCode":false,"width":6,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","#### Simplify sources for the model using a view.","","It's good to simplify your sources to make the model more effective. For example, you may have tables with overlapping content - creating a view that includes the correct columns will make SQL generation more reliable. Let's create a view to disambiguate customer information.","","","* Create a view to join `CUSTOMER_CONTACT`, `CUSTOMER_SEGMENT` and `CUSTOMER_SEGMENT`","* Update the AI profile to include this new view"],"enabled":true,"result":{"startTime":1734028147254,"interpreter":"md.low","endTime":1734028147718,"results":[{"message":"<h4 id=\"simplify-sources-for-the-model-using-a-view\">Simplify sources for the model using a view.<\/h4>\n<p>It's good to simplify your sources to make the model more effective. For example, you may have tables with overlapping content - creating a view that includes the correct columns will make SQL generation more reliable. Let's create a view to disambiguate customer information.<\/p>\n<ul>\n<li>Create a view to join <code>CUSTOMER_CONTACT<\/code>, <code>CUSTOMER_SEGMENT<\/code> and <code>CUSTOMER_SEGMENT<\/code><\/li>\n<li>Update the AI profile to include this new view<\/li>\n<\/ul>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":12,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":"Create a view to simplify the content","message":["%sql","","CREATE OR REPLACE VIEW v_customer AS","SELECT","    cc.cust_id,","    cc.last_name,","    cc.first_name,","    cc.email,","    cc.street_address,","    cc.postal_code,","    cc.city,","    cc.state_province,","    cc.country,","    cc.country_code,","    cc.continent,","    cc.yrs_customer,","    ce.age,","    ce.commute_distance,","    ce.credit_balance,","    ce.education,","    ce.full_time,","    ce.gender,","    ce.household_size,    ","    ce.income_level,","    ce.job_type,","    ce.marital_status,","    ce.num_cars,","    ce.pet,","    ce.rent_own,","    ce.segment_id,","    ce.work_experience,","    ce.yrs_current_employer,","    ce.yrs_residence,","    cs.short_name as segment_name","FROM","    customer_extension ce, customer_contact cc, customer_segment cs","WHERE ","    ce.cust_id = cc.cust_id","AND ce.segment_id = cs.segment_id; "],"enabled":true,"result":{"startTime":1734042592421,"interpreter":"sql.low","endTime":1734042598537,"results":null,"taskStatus":null,"forms":null,"status":null},"sizeX":0,"hideCode":false,"width":6,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Segment name is part of the view","message":["%sql","","select cust_id, last_name, segment_name","from v_customer","where rownum < 10;"],"enabled":true,"result":{"startTime":1734027878128,"interpreter":"sql.low","endTime":1734027878593,"results":null,"taskStatus":null,"forms":null,"status":null},"sizeX":0,"hideCode":false,"width":6,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"Recreate the profile using the view","message":["%script","","DECLARE","   AI_PROVIDER varchar2(10) := 'oci';  -- valid values are oci, azure, google, openai","   AI_CREDENTIAL_NAME varchar2(100) := 'GENAI_CRED'; -- The name of your credential.","   -- When using Azure OpenAI - fill in the fields below","   AZURE_OPENAI_RESOURCE_NAME varchar2(100) :='';  -- This is your Azure OpenAI resource name","   AZURE_OPENAI_DEPLOYMENT_NAME  varchar2(100):='';  -- This is your Azure OpenAI deployment name","BEGIN","    ","    -- ~~~~~~~~~~~~~~","    -- recreate the profile but replace the CUSTOMER table with the V_CUSTOMER view","    -- ~~~~~~~~~~~~~~    ","","    dbms_cloud_ai.drop_profile (","        profile_name => 'GENAI',","        force => true","    );","    -- create an AI profile. The attributes are different for providers.","    IF upper(AI_PROVIDER) = 'AZURE' THEN","      dbms_cloud_ai.create_profile (","          profile_name => 'GENAI',","          attributes =>","              '{\"provider\": \"azure\",","                  \"azure_resource_name\": \"AZURE_OPENAI_RESOURCE_NAME\",","                  \"azure_deployment_name\": \"AZURE_OPENAI_DEPLOYMENT_NAME\",","                  \"credential_name\": \"AI_CREDENTIAL_NAME\",","                  \"comments\":\"true\",","                  \"object_list\": [","                  {\"owner\": \"MOVIESTREAM\", \"name\": \"GENRE\"},","                  {\"owner\": \"MOVIESTREAM\", \"name\": \"V_CUSTOMER\"},","                  {\"owner\": \"MOVIESTREAM\", \"name\": \"PIZZA_SHOP\"},","                  {\"owner\": \"MOVIESTREAM\", \"name\": \"STREAMS\"},","                  {\"owner\": \"MOVIESTREAM\", \"name\": \"MOVIES\"},","                  {\"owner\": \"MOVIESTREAM\", \"name\": \"ACTORS\"}","                  ]","                  }'","      );","    ELSE","      dbms_cloud_ai.create_profile (","          profile_name => 'GENAI',","          attributes =>","              '{\"provider\": \"' || AI_PROVIDER || '\",","                  \"credential_name\": \"' || AI_CREDENTIAL_NAME ||'\",","                  \"region\": \"sa-saopaulo-1\",","                  \"comments\":\"true\",","                  \"object_list\": [","                  {\"owner\": \"MOVIESTREAM\", \"name\": \"GENRE\"},","                  {\"owner\": \"MOVIESTREAM\", \"name\": \"V_CUSTOMER\"},","                  {\"owner\": \"MOVIESTREAM\", \"name\": \"PIZZA_SHOP\"},","                  {\"owner\": \"MOVIESTREAM\", \"name\": \"STREAMS\"},","                  {\"owner\": \"MOVIESTREAM\", \"name\": \"MOVIES\"},","                  {\"owner\": \"MOVIESTREAM\", \"name\": \"ACTORS\"}","                  ]","                }'","      );","    END IF;","","-- ~~~~~~~~~~~~~~","-- Set the AI profile for this session","-- ~~~~~~~~~~~~~~","","dbms_cloud_ai.set_profile(profile_name =>'genai');","END;","/"],"enabled":true,"result":{"startTime":1734042628969,"interpreter":"script.low","endTime":1734042637895,"results":null,"taskStatus":null,"forms":null,"status":null},"sizeX":0,"hideCode":false,"width":0,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"bar","title":"Success! Sales by customer segment","message":["%sql","","","select ai runsql What are sales by customer segment"],"enabled":true,"result":{"startTime":1734042659285,"interpreter":"sql.low","endTime":1734042663493,"results":null,"taskStatus":null,"forms":null,"status":null},"sizeX":0,"hideCode":false,"width":0,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","#### Use a PLSQL API to access the LLM","You can use a PLSQL API to access the LLM. This is useful for tools that are unable to use the SQL interface. Here's a couple examples that use `DBMS_CLOUD_AI.GENERATE` that to translate natural lange to SQL.","","This approach is used by the **Ask Autonomous** APEX app."],"enabled":true,"result":{"startTime":1734028164470,"interpreter":"md.low","endTime":1734028164953,"results":[{"message":"<h4 id=\"use-a-plsql-api-to-access-the-llm\">Use a PLSQL API to access the LLM<\/h4>\n<p>You can use a PLSQL API to access the LLM. This is useful for tools that are unable to use the SQL interface. Here's a couple examples that use <code>DBMS_CLOUD_AI.GENERATE<\/code> that to translate natural lange to SQL.<\/p>\n<p>This approach is used by the <strong>Ask Autonomous<\/strong> APEX app.<\/p>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":0,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":true,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"Chat using the PL/SQL API","message":["%script","","declare","    l_prompt varchar2(4000) := 'Who is Tom Hanks?';","    l_response clob;","    l_profile_name varchar2(100) := 'genai';","begin","    l_response := dbms_cloud_ai.generate(","                    prompt          => l_prompt,","                    profile_name    => l_profile_name,","                    action          => 'chat'                    ","                );","    dbms_output.put_line(l_response);","end;    "],"enabled":true,"result":{"startTime":1734042686784,"interpreter":"script.low","endTime":1734042708985,"results":null,"taskStatus":null,"forms":null,"status":null},"sizeX":0,"hideCode":false,"width":0,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"SHOWSQL using the PL/SQL API","message":["%script","","","declare","    l_prompt varchar2(4000) := 'What are our total streams by customer segment';","    l_response clob;","    l_profile_name varchar2(100) := 'genai';","begin","    l_response := dbms_cloud_ai.generate(","                    prompt          => l_prompt,","                    profile_name    => l_profile_name,","                    action          => 'showsql'                    ","                );","    dbms_output.put_line(l_response);","end; "],"enabled":true,"result":{"startTime":1734042727802,"interpreter":"script.low","endTime":1734042731223,"results":null,"taskStatus":null,"forms":null,"status":null},"sizeX":0,"hideCode":false,"width":0,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","#### What to do when my table and column names are difficult to understand?","It's convenient that our movie data is contained in tables that use clear names. Unfortunately, that's oftentimes not the case! ","","Use **COMMENTS** on tables and columns to help the model understand their meaning.","","We'll create views with meaningless names and then try a natural language query. Then, we'll apply comments to see how they help."],"enabled":true,"result":{"startTime":1734028171238,"interpreter":"md.low","endTime":1734028171709,"results":[{"message":"<h4 id=\"what-to-do-when-my-table-and-column-names-are-difficult-to-understand\">What to do when my table and column names are difficult to understand?<\/h4>\n<p>It's convenient that our movie data is contained in tables that use clear names. Unfortunately, that's oftentimes not the case!<\/p>\n<p>Use <strong>COMMENTS<\/strong> on tables and columns to help the model understand their meaning.<\/p>\n<p>We'll create views with meaningless names and then try a natural language query. Then, we'll apply comments to see how they help.<\/p>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":0,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"Create views with generic names","message":["%script","","-- movies","CREATE or REPLACE VIEW view1","AS SELECT ","    movie_id as c1,","    title as c2,","    year as c3","FROM movies;","","-- streams","CREATE OR REPLACE VIEW view2 as","SELECT DAY_ID as c1,","    GENRE_ID as c2,","    MOVIE_ID as c3,","    CUST_ID as c4,","    DEVICE as c5,","    SALES as c6,","    VIEWS as c7","FROM STREAMS;","","-- genres","create or replace view view3 as","SELECT ","    GENRE_ID as c1,","    NAME as c2","FROM GENRE;"],"enabled":true,"result":{"startTime":1734042755133,"interpreter":"script.low","endTime":1734042755751,"results":null,"taskStatus":null,"forms":null,"status":null},"sizeX":0,"hideCode":false,"width":0,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":"Query VIEW3","message":["%sql","SELECT * FROM view3;"],"enabled":true,"result":{"startTime":1734042772328,"interpreter":"sql.low","endTime":1734042773821,"results":null,"taskStatus":null,"forms":null,"status":null},"sizeX":0,"hideCode":false,"width":0,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md ","#### Create a new AI profile that uses COMMENTS","","We'll create a new AI profile called `USING_COMMENTS`. Notice that the profile has an attribute `\"comments\":\"true\"`. This tells Select AI to send comments with the LLM request.","","We still haven't added comments to our objects - that will come next!"],"enabled":true,"result":{"startTime":1734028178168,"interpreter":"md.low","endTime":1734028178625,"results":[{"message":"<h4 id=\"create-a-new-ai-profile-that-uses-comments\">Create a new AI profile that uses COMMENTS<\/h4>\n<p>We'll create a new AI profile called <code>USING_COMMENTS<\/code>. Notice that the profile has an attribute <code>&quot;comments&quot;:&quot;true&quot;<\/code>. This tells Select AI to send comments with the LLM request.<\/p>\n<p>We still haven't added comments to our objects - that will come next!<\/p>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":0,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"Create the new profile","message":["%script","","begin","  dbms_cloud_ai.drop_profile(","    profile_name => 'USING_COMMENTS',","    force => true","    );","","  dbms_cloud_ai.create_profile(","    profile_name => 'USING_COMMENTS',","    attributes =>       ","        '{\"provider\": \"oci\",","          \"credential_name\": \"GENAI_CRED\",","          \"region\": \"sa-saopaulo-1\",","          \"comments\":\"true\", ","          \"object_list\": [","            {\"owner\": \"MOVIESTREAM\", \"name\": \"view1\"},","            {\"owner\": \"MOVIESTREAM\", \"name\": \"view2\"},","            {\"owner\": \"MOVIESTREAM\", \"name\": \"view3\"}             ","          ]          ","          }'","    );","    ","    dbms_cloud_ai.set_profile(","        profile_name => 'USING_COMMENTS'","    );","end;"],"enabled":true,"result":{"startTime":1734042790224,"interpreter":"script.low","endTime":1734042804694,"results":null,"taskStatus":null,"forms":null,"status":null},"sizeX":0,"hideCode":false,"width":0,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":"No comments, no luck!","message":["%sql","","select ai runsql What are our total views by genre"],"enabled":true,"result":{"startTime":1734042829781,"interpreter":"sql.low","endTime":1734042833181,"results":null,"taskStatus":null,"forms":null,"status":null},"sizeX":0,"hideCode":false,"width":0,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":true,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"html","title":null,"message":["%md","##### Add comments to the views","Apply comments to the views that describe their meaning. This is really helpful - not just in this case where it's absolutely needed - but in most every case. It helps the LLM find the right information."],"enabled":true,"result":{"startTime":1734028184641,"interpreter":"md.low","endTime":1734028185142,"results":[{"message":"<h5 id=\"add-comments-to-the-views\">Add comments to the views<\/h5>\n<p>Apply comments to the views that describe their meaning. This is really helpful - not just in this case where it's absolutely needed - but in most every case. It helps the LLM find the right information.<\/p>\n","type":"HTML"}],"taskStatus":"SUCCESS","forms":"[]","status":"SUCCESS"},"sizeX":0,"hideCode":true,"width":0,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"raw","title":null,"message":["%script","","-- Movies","COMMENT ON TABLE view1 IS 'Contains movies, movie titles and the year it was released';","COMMENT ON COLUMN view1.c1 IS 'movie ids. Use this column to join to other views';","COMMENT ON COLUMN view1.c2 IS 'movie titles';","COMMENT ON COLUMN view1.c3 IS 'year the movie was released';","","-- Streams","COMMENT ON TABLE view2 IS 'transactions for movie views - also known as streams';","COMMENT ON COLUMN view2.c1 IS 'day the movie was streamed';","COMMENT ON COLUMN view2.c2 IS 'genre ids. Use this column to join to other views';","COMMENT ON COLUMN view2.c3 IS 'movie ids. Use this column to join to other views';","COMMENT ON COLUMN view2.c4 IS 'customer ids. Use this column to join to other views';","COMMENT ON COLUMN view2.c5 IS 'device used to stream, watch or view the movie';","COMMENT ON COLUMN view2.c6 IS 'sales from the movie';","COMMENT ON COLUMN view2.c7 IS 'number of views, watched, streamed';","","-- Genres","COMMENT ON TABLE view3 IS 'Contains the genres';","COMMENT ON COLUMN view3.c1 IS 'genre id. use this column to join to other views';","COMMENT ON COLUMN view3.c2 IS 'name of the genre';"],"enabled":true,"result":{"startTime":1734042871572,"interpreter":"script.low","endTime":1734042872183,"results":null,"taskStatus":null,"forms":null,"status":null},"sizeX":0,"hideCode":false,"width":0,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"},{"col":0,"visualizationConfig":null,"hideInIFrame":false,"selectedVisualization":"table","title":null,"message":["%sql","","select ai runsql what are our top 10 most viewed movies"],"enabled":true,"result":{"startTime":1734042910282,"interpreter":"sql.low","endTime":1734042924677,"results":null,"taskStatus":null,"forms":null,"status":null},"sizeX":0,"hideCode":false,"width":0,"hideResult":false,"dynamicFormParams":"{}","row":0,"hasTitle":false,"hideVizConfig":false,"hideGutter":true,"relations":[],"forms":"[]"}],"version":"7","snapshot":false,"tags":null}]