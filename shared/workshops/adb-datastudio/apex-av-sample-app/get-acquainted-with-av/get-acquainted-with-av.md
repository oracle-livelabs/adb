# Examine Hierarchies and Analytic Views

## Introduction

Hierarchy views return data from a single hierarchy. Analytic views join one or more hierarchies with a fact table. They include all hierarchy columns, fact measures, and calculated measures. Both types return rows at all levels.

**Estimated Time:** 5 minutes

### Objectives

- Learn about the columns and rows returned by hierarchies and analytic views.

### Prerequisites

- Complete the previous lab.

## Task 1 - Select from the Time Hierarchy

Hierarchies include:

- **Attribute columns** from the underlying table(s)  
- **Hierarchical columns** generated by the hierarchy

Each hierarchy returns rows for all levels.  
Use the `HIER_ORDER` column to sort members in hierarchical order.

~~~SQL
<copy>
SELECT
  *
FROM
  time
ORDER BY
  hier_order;
</copy>
~~~

## Task 2 - Select Attribute Columns at the Day Level

To get original data from `TIME_DIM`, filter by the `DAY` level:

~~~SQL
<copy>
SELECT
  day_id,
  month,
  quarter,
  year
FROM
  time
WHERE
  level_name = 'DAY'
ORDER BY
  hier_order;
</copy>
~~~

## Task 3 - Select Primary Key, Attribute, and LEVEL_NAME Columns

The following query adds hierarchy metadata:

~~~SQL
<copy>
SELECT
  member_unique_name,
  level_name,
  day_id,
  month,
  quarter,
  year
FROM
  time
ORDER BY
  hier_order;
</copy>
~~~

- Attribute columns show values for the current level and its ancestors  
- Descendant columns return `NULL`  
- All hierarchies include a top-level `ALL` member

## Task 4 - Select all Hierarchical Attributes

This query returns all hierarchy-specific metadata:

~~~SQL
<copy>
SELECT
    member_unique_name
  , member_name
  , member_caption
  , member_description
  , hier_order
  , level_name
  , depth
  , is_leaf
  , parent_unique_name
  , parent_level_name
FROM
    time
ORDER BY
    hier_order;
</copy>
~~~

Column usage:

- `MEMBER_UNIQUE_NAME` – Hierarchy primary key  
- `MEMBER_NAME`, `MEMBER_CAPTION`, `MEMBER_DESCRIPTION` – User-friendly values  
- `HIER_ORDER` – Sorts members hierarchically  
- `LEVEL_NAME` – Shows the member’s level  
- `DEPTH` – Distance from the root (ALL level)  
- `IS_LEAF` – Indicates if the member has no children  
- `PARENT_UNIQUE_NAME`, `PARENT_LEVEL_NAME` – Info about the parent node  

These columns are ideal for building navigation menus and LOVs in APEX.

## Important - Do not SELECT * FROM Analytic Views

Avoid selecting all rows and columns from an analytic view.

Analytic views return all combinations of hierarchy members and measures.  
If you use 4 hierarchies with 1,000 members each, the result could exceed **1 billion rows** (`1000^4`), though sparse data usually reduces this.

**Best practices:**

- Filter your queries  
- Select only required columns  
- Use specific hierarchy levels

## Task 5 - Take a First Look at the Analytic View

Analytic views include all hierarchy and measure columns.  
Hierarchical columns follow a consistent naming convention, while attribute columns vary.

Get a list of all columns with:

~~~SQL
<copy>
SELECT
    analytic_view_name
  , hier_name
  , column_name
  , role
FROM
  user_analytic_view_columns
ORDER BY
  order_num;
</copy>
~~~

You may now **proceed to the next lab**.

## Acknowledgements

- **Created By** - William (Bud) Endress, Product Manager, Autonomous Database, June 2023  
- **Last Updated By** - William (Bud) Endress, June 2025

Data about movies in this workshop were sourced from **Wikipedia**.

Copyright (C) Oracle Corporation.

Permission is granted to copy, distribute and/or modify this document under the terms of the GNU Free Documentation License, Version 1.3 or any later version published by the Free Software Foundation;  with no Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.  A copy of the license is included in the section entitled [GNU Free Documentation License](files/gnu-free-documentation-license.txt)
