{"paragraphs":[{"text":"%md\n\n# Using the OML AutoML UI model for scoring\n\nIn this simple scoring exercise we will use the model that was created in the OML AutoML UI to score the customers in the existing `MOVIESTREAM_CHURN` table, in order to prepare a list of potential customers that would churn in the future that we would need to contact with an offer.\n\nIn the code below we need to make sure we use `the same model name` we used in OML AutoML UI, which in this example is `CHURN_PRED`.  \n\nIf you used a different name please make the appropriate changes in the *PREDICTION* and *PREDICTION_PROBABILITY* SQL functions in the \"Create a new table LATEST_POTENTIAL_CHURNERS\" paragraph.\n\nCheck the following links for more information:\n- <a href=\"https://docs.oracle.com/en/database/oracle/oracle-database/19/sqlrf/PREDICTION.html#GUID-DA66A1C3-BFB2-43A1-A3FF-93D4A3DAB9C6\" onclick=\"return ! window.open('https://docs.oracle.com/en/database/oracle/oracle-database/19/sqlrf/PREDICTION.html#GUID-DA66A1C3-BFB2-43A1-A3FF-93D4A3DAB9C6');\">Documentation on Oracle SQL function PREDICTION</a>\n- <a href=\"https://docs.oracle.com/en/database/oracle/oracle-database/19/sqlrf/PREDICTION_PROBABILITY.html#GUID-0F309771-40A3-4E23-9A96-CD134C80F584\" onclick=\"return ! window.open('https://docs.oracle.com/en/database/oracle/oracle-database/19/sqlrf/PREDICTION_PROBABILITY.html#GUID-0F309771-40A3-4E23-9A96-CD134C80F584');\">Documentation on Oracle SQL function PREDICTION_PROBABILITY</a>\n\nCopyright (c) 2021 Oracle Corporation \n###### <a href=\"https://oss.oracle.com/licenses/upl/\" onclick=\"return ! window.open('https://oss.oracle.com/licenses/upl/');\">The Universal Permissive License (UPL), Version 1.0</a>\n---","user":"MOVIESTREAM","dateUpdated":"2021-10-08T18:34:34+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","fontSize":9,"results":{},"editorSetting":{"language":"md","editOnDblClick":false},"editorHide":true},"settings":{"params":{},"forms":{}},"interrupted":false,"jobName":"paragraph_1633535797650_-1930176769","id":"20211006-155637_1427966616","dateCreated":"2021-08-11T07:03:45+0000","dateStarted":"2021-10-08T18:34:35+0000","dateFinished":"2021-10-08T18:34:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":false,"focus":true,"$$hashKey":"object:538","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Using the OML AutoML UI model for scoring</h1>\n<p>In this simple scoring exercise we will use the model that was created in the OML AutoML UI to score the customers in the existing <code>MOVIESTREAM_CHURN</code> table, in order to prepare a list of potential customers that would churn in the future that we would need to contact with an offer.</p>\n<p>In the code below we need to make sure we use <code>the same model name</code> we used in OML AutoML UI, which in this example is <code>CHURN_PRED</code>.</p>\n<p>If you used a different name please make the appropriate changes in the <em>PREDICTION</em> and <em>PREDICTION_PROBABILITY</em> SQL functions in the &ldquo;Create a new table LATEST_POTENTIAL_CHURNERS&rdquo; paragraph.</p>\n<p>Check the following links for more information:</p>\n<ul>\n<li><a href=\"https: //docs.oracle.com/en/database/oracle/oracle-database/19/sqlrf/PREDICTION.html#GUID-DA66A1C3-BFB2-43A1-A3FF-93D4A3DAB9C6\" onclick=\"return ! window.open('https://docs.oracle.com/en/database/oracle/oracle-database/19/sqlrf/PREDICTION.html#GUID-DA66A1C3-BFB2-43A1-A3FF-93D4A3DAB9C6');\">Documentation on Oracle SQL function PREDICTION</a></li>\n<li><a href=\"https: //docs.oracle.com/en/database/oracle/oracle-database/19/sqlrf/PREDICTION_PROBABILITY.html#GUID-0F309771-40A3-4E23-9A96-CD134C80F584\" onclick=\"return ! window.open('https://docs.oracle.com/en/database/oracle/oracle-database/19/sqlrf/PREDICTION_PROBABILITY.html#GUID-0F309771-40A3-4E23-9A96-CD134C80F584');\">Documentation on Oracle SQL function PREDICTION_PROBABILITY</a></li>\n</ul>\n<p>Copyright (c) 2021 Oracle Corporation</p>\n<h6><a href=\"https: //oss.oracle.com/licenses/upl/\" onclick=\"return ! window.open('https://oss.oracle.com/licenses/upl/');\">The Universal Permissive License (UPL), Version 1.0</a></h6>\n<hr />\n"}]}},{"title":"Remove the table if it exists","text":"%script\n\nBEGIN EXECUTE IMMEDIATE 'DROP TABLE LATEST_POTENTIAL_CHURNERS';\n      EXCEPTION WHEN OTHERS THEN NULL; \nEND;","user":"MOVIESTREAM","dateUpdated":"2021-10-08T18:34:35+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"plsql","editOnDblClick":false},"editorMode":"ace/mode/plsql","title":true},"settings":{"params":{},"forms":{}},"interrupted":false,"jobName":"paragraph_1633535797650_1086486355","id":"20211006-155637_580136483","dateCreated":"2021-08-12T07:03:54+0000","dateStarted":"2021-10-08T18:34:36+0000","dateFinished":"2021-10-08T18:34:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":false,"$$hashKey":"object:539","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nPL/SQL procedure successfully completed.\n\n"}]}},{"title":"Create a new table LATEST_POTENTIAL_CHURNERS","text":"%sql\n\nCREATE TABLE LATEST_POTENTIAL_CHURNERS AS   \nSELECT * FROM \n      (SELECT CUST_ID, \n              PREDICTION(CHURN_PRED USING M.*) WILL_CHURN,\n              ROUND(PREDICTION_PROBABILITY(CHURN_PRED, '1'  USING M.*),6) PROB_CHURN\n              FROM MOVIESTREAM_CHURN M)\n       ORDER BY PROB_CHURN DESC;\n\n","user":"MOVIESTREAM","dateUpdated":"2021-10-08T18:34:36+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"CUST_ID":"string","WILL_CHURN":"string","PROB_CHURN":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/osql","title":true},"settings":{"params":{},"forms":{}},"interrupted":false,"jobName":"paragraph_1633535797650_1976477805","id":"20211006-155637_1207653073","dateCreated":"2021-08-11T07:05:21+0000","dateStarted":"2021-10-08T18:34:37+0000","dateFinished":"2021-10-08T18:34:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":false,"$$hashKey":"object:540","results":{"code":"SUCCESS","msg":[]}},{"text":"%md\n### Let's review a small sample of the table in order to see a variety of probabilities\n---\n","user":"MOVIESTREAM","dateUpdated":"2021-10-08T18:34:37+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"md","editOnDblClick":false},"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"interrupted":false,"jobName":"paragraph_1633535797650_-839839019","id":"20211006-155637_679955441","dateCreated":"2021-10-06T15:15:21+0000","dateStarted":"2021-10-08T18:34:38+0000","dateFinished":"2021-10-08T18:34:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":false,"$$hashKey":"object:541","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Let's review a small sample of the table in order to see a variety of probabilities</h3>\n<hr />\n"}]}},{"title":"Small sample output (1% of the customers)","text":"%sql\n\nSELECT * FROM LATEST_POTENTIAL_CHURNERS SAMPLE(1)\n         ORDER BY PROB_CHURN DESC;\n","user":"MOVIESTREAM","dateUpdated":"2021-10-08T18:34:38+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"CUST_ID":"string","WILL_CHURN":"string","PROB_CHURN":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/osql","title":true},"settings":{"params":{},"forms":{}},"interrupted":false,"jobName":"paragraph_1633535797650_-443359010","id":"20211006-155637_368303539","dateCreated":"2021-08-12T07:06:16+0000","dateStarted":"2021-10-08T18:34:38+0000","dateFinished":"2021-10-08T18:34:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"commited":false,"$$hashKey":"object:542","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"CUST_ID\tWILL_CHURN\tPROB_CHURN\n1421092\t1\t1\n1022584\t1\t1\n1128274\t1\t0.775281\n1409484\t1\t0.775281\n1049560\t1\t0.775281\n1192680\t0\t0.005076\n1244896\t0\t0.005076\n1243434\t0\t0.005076\n1054834\t0\t0.003436\n1055262\t0\t0.003436\n1064746\t0\t0.003436\n1372080\t0\t0.003436\n1156753\t0\t0.003436\n1353280\t0\t0.003436\n1073217\t0\t0.003436\n1350093\t0\t0\n"}]}},{"text":"%sql\n","user":"MOVIESTREAM","dateUpdated":"2021-10-08T18:29:17+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false},"editorMode":"ace/mode/osql"},"settings":{"params":{},"forms":{}},"interrupted":false,"jobName":"paragraph_1633535797650_-848816477","id":"20211006-155637_370482200","dateCreated":"2021-08-11T07:11:42+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"commited":false,"$$hashKey":"object:543"}],"name":"Scoring customers with Churn Model","id":"1460442","noteParams":{},"noteForms":{},"angularObjects":{"ORA99E1F35ED3:MOVIESTREAM:1460442":[],"ORA3E02A28C53:MOVIESTREAM:1460442":[],"ORA466057A055:MOVIESTREAM:1460442":[],"MDWC6F71EE9E1:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}